<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-start">Gestión de Productos</h2>
    <button class="btn btn-primary info-button d-flex justify-content-center align-items-center" data-bs-toggle="modal"
      data-bs-target="#infoModal" style="background-color: rgb(0, 68, 255); 
           width: 40px; 
           height: 40px; 
           border-radius: 5px; 
           padding: 0; 
           border: none;">
      <!-- Ícono de información -->
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#ffffff" class="bi bi-info-circle">
        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
        <path
          d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
      </svg>
    </button>
  </div>

  <!-- Modal de Información -->
  <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="infoModalLabel">
            Información sobre la Página
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>
            En esta página, puedes gestionar el listado de productos disponibles en el sistema. A continuación, se
            detallan las funciones que puedes realizar:
          </p>
          <ul>
            <li><strong>Filtrar productos:</strong> Utiliza las opciones de filtrado para buscar productos específicos
              en la lista. Puedes filtrar por diferentes criterios, como el nombre del proveedor, el estado y el rango
              de precios.</li>
            <li><strong>Seleccionar productos:</strong> Marca los productos que deseas eliminar utilizando las casillas
              de verificación situadas a la derecha de cada fila.</li>
            <li><strong>Justificativo de eliminación:</strong> Antes de confirmar la eliminación de productos, deberás
              proporcionar un justificativo en el campo correspondiente.</li>
            <li><strong>Navegación entre páginas:</strong> Utiliza los botones de navegación para desplazarte por las
              diferentes páginas de productos si hay una gran cantidad de ellos.</li>
            <li><strong>Exportar datos:</strong> Puedes exportar la lista de productos a formatos PDF y Excel utilizando
              los botones correspondientes en la parte superior de la lista.</li>
          </ul>
          <p>
            Asegúrate de proporcionar un justificativo antes de confirmar la eliminación de productos seleccionados.
            Esta acción no se puede deshacer.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>



  <!-- Modal de Confirmación de Eliminación con Justificativo -->
  <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmDeleteModalLabel">
            Confirmación de Eliminación
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>¿Está seguro que desea eliminar los productos seleccionados?</p>
          <div class="mb-3">
            <label for="modalJustificativo" class="form-label">Justificativo</label>
            <textarea id="modalJustificativo" class="form-control" [(ngModel)]="justificativo" rows="3"
              placeholder="Escribe el motivo por el cual se borran los productos seleccionados"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="confirmDelete()"
            [disabled]="justificativo.trim() === ''">
            Eliminar
          </button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>

<!-- Sección: Opciones de Búsqueda y Acciones -->
<div class="d-flex mb-3 justify-content-between align-items-center">
  <!-- Contenedor Izquierdo: Campo de Búsqueda y ComboBox -->
  <div class="d-flex align-items-center">
    <!-- Campo de Búsqueda -->
    <input type="text" id="filterInput" class="form-control me-3" placeholder="Buscar"
      (input)="applyFilter($event)" />

    <!-- ComboBox de Estado con el evento (change) para filtrar -->
    <select id="estadoSelect" class="form-select" style="width: auto;" (change)="applyStateFilter($event)">
      <option value="">Seleccionar Estado</option>
      <option value="Disponible">Disponible</option>
      <option value="Mantenimiento">Mantenimiento</option>
      <option value="Prestado">Prestado</option>
    </select>
  </div>

  <!-- Contenedor Derecho: Selección y Botones de Exportación -->
  <div class="d-flex align-items-center">
    <input type="checkbox" id="selectAll" (change)="toggleSelectAll($event)" class="form-check-input me-2" />
    <label for="selectAll" class="me-3">Seleccionar Todo</label>

    <button class="btn btn-success me-2" (click)="generateExcel()">
      <i class="bi bi-file-earmark-excel"></i>
    </button>
    <button class="btn btn-danger me-2" (click)="generatePDF()">
      <i class="bi bi-file-earmark-pdf"></i>
    </button>
  </div>
</div>



  <!-- Sección: Tabla de Detalles de Productos -->
  <div class="table-responsive mb-4 justify-content-between">
    <table id="productTable" class="table table-striped table-bordered w-100">
      <thead>
        <tr>
          <th>Descripción</th>
          <th>Nombre del Proveedor</th>
          <th>Estado</th>
          <th class="text-end">Precio</th>
          <th class="text-center">Seleccionar</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let detail of details">
          <td>{{ detail.description }}</td>
          <td>{{ detail.supplierName }}</td>
          <td>{{ detail.state }}</td>
          <td class="text-end">{{ detail.price | currency : "USD" }}</td>
          <td class="text-center">
            <input type="checkbox" [checked]="selectedIds.includes(detail.id)" (change)="toggleSelection(detail.id)" />
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Sección: Botones de Acción -->
  <div class="d-flex justify-content-end">
    <button class="btn btn-secondary me-2" (click)="volverInventario()">
      Volver
    </button>

    <button id="deleteButton" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"
      [disabled]="selectedIds.length === 0">
      Eliminar
    </button>
  </div>
</div>